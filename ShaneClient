Windows Client:

Configuration
1. # Set Adapter to use DHCP  
Set-NetIPInterface -InterfaceAlias 'Ethernet' -Dhcp Enabled

2. # Release and Renew IP to get DHCP Address
Ipconfig /release
Ipconfig /renew

3. # Verify Adapter Interface IDs
Get-NetIPInterface

4. # Set a high priority metric for internal NIC - The lower the metric means higher priority - primary traffic goes over internal network
Set-NetIPInterface -InterfaceIndex “<ifIndex#>” -InterfaceMetric “1”

5. # Set a low priority metric for external NIC - The higher the metric means lower priority - traffic that can't be resolved goes out to 8.8.8.8 on external adapter
Set-NetIPInterface -InterfaceIndex “<ifIndex#>” -InterfaceMetric “2”

6. # Disable firewall
Set-NetFirewallProfile -Enabled False

7. # Disable IPv6
Disable-NetAdapterBinding -Name "Ethernet" -ComponentID ms_tcpip6

8. # Setting Hostname
Rename-Computer -NewName "ShaneClient"
Restart-Computer

9. # Update PowerShell Help
Update-Help

10. # Install PowerShell Version 7
Invoke-Expression "& { $(Invoke-RestMethod 'https://aka.ms/install-powershell.ps1') } -useMSI -Quiet -EnablePSRemoting"

11. # Install NuGet Package manager, prerequisite for installing modules
Install-PackageProvider -Name NuGet -MinimumVersion 2.8.5.201 -Force

$Modules = @( 
"Az", 
"AzureAD", 
"MicrosoftTeams", 
"ExchangeOnlineManagement", 
"Microsoft.Online.SharePoint.PowerShell", 
"SharePointPnPPowerShellOnline", 
"Microsoft.Graph", 
"MSOnline" 
)

12. # Installing Modules
Install-Module -Name $Modules -Force

13. # Setting Time Zone
Set-TimeZone -Name "Eastern Standard Time"

14. # Join the Client to the Domain 
Add-Computer -DomainCredential administrator -Server "Shaneserver" -DomainName "Shane.local"
Restart-Computer
